<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PrintFarmButton Flasher</title>
  <script type="module" src="https://unpkg.com/esp-web-tools@10.0.0/dist/web/install-button.js?module"></script>
  <style>
    body {
      margin: auto;
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      overflow: auto;
      background: linear-gradient(315deg, rgba(101,0,94,1) 3%, rgba(60,132,206,1) 38%, rgba(48,238,226,1) 68%, rgba(255,25,25,1) 98%);
      animation: gradient 15s ease infinite;
      background-size: 400% 400%;
      background-attachment: fixed;
    }
    @keyframes gradient {
      0% { background-position: 0% 0%; }
      50% { background-position: 100% 100%; }
      100% { background-position: 0% 0%; }
    }
    .wave {
      background: rgb(255 255 255 / 25%);
      border-radius: 1000% 1000% 0 0;
      position: fixed;
      width: 200%;
      height: 12em;
      animation: wave 10s -3s linear infinite;
      transform: translate3d(0, 0, 0);
      opacity: 0.8;
      bottom: 0;
      left: 0;
      z-index: -1;
    }
    .wave:nth-of-type(2) {
      bottom: -1.25em;
      animation: wave 18s linear reverse infinite;
      opacity: 0.8;
    }
    .wave:nth-of-type(3) {
      bottom: -2.5em;
      animation: wave 20s -1s reverse infinite;
      opacity: 0.9;
    }
    @keyframes wave {
      2% { transform: translateX(1); }
      25% { transform: translateX(-25%); }
      50% { transform: translateX(-50%); }
      75% { transform: translateX(-25%); }
      100% { transform: translateX(1); }
    }
    .container { max-width: 500px; margin: 10px auto 40px auto; background: #fff; border-radius: 8px; box-shadow: 0 2px 8px #0001; padding: 2em; }
    h1 { text-align: center; }
    label { font-weight: bold; }
    select, button { width: 100%; padding: 0.7em; margin: 1em 0; font-size: 1em; }
    esp-web-install-button { width: 100%; }
    .desc { color: #555; text-align: center; margin-bottom: 1.5em; }
  </style>
</head>
<body>
  <div>
    <div class="wave"></div>
    <div class="wave"></div>
    <div class="wave"></div>
  </div>
  <div class="container">
    <h1>PrintFarmButton Flasher</h1>
    <div class="desc">Select your board type and flash the latest firmware using your browser.</div>
    <div style="margin-bottom:1.5em;">
      <div style="text-align:center; font-size:1.2em; color:#1976d2; font-weight:bold; margin-bottom:0.5em;">Kit</div>
      <div id="kit-board" style="display: flex; justify-content: center;">
        <div class="board-option" data-board="esp32s3-zero" tabindex="0" style="cursor:pointer; border: 2px solid #3c84ce; border-radius: 8px; padding: 0.5em; background: #e6f0fa; transition: border 0.2s;">
          <img src="images/button.png" alt="PrintFarmButton Kit" style="width: 120px; height: 120px; object-fit: cover; border-radius: 6px; display: block; margin: 0 auto 0.5em;">
          <div style="text-align:center; font-weight:bold;">PrintFarmButton Kit</div>
        </div>
      </div>
    </div>
    <div style="margin-bottom:2em;">
      <div style="text-align:center; font-size:1.2em; color:#1976d2; font-weight:bold; margin-bottom:0.5em;">DIY</div>
      <div id="board-images" style="display: flex; flex-wrap: wrap; gap: 1em; justify-content: center;">
        <div class="board-option" data-board="esp32s3-supermini" tabindex="0" style="cursor:pointer; border: 2px solid #ccc; border-radius: 8px; padding: 0.5em; background: #fafafa; transition: border 0.2s;">
          <img src="images/s3supermini.jpg" alt="ESP32S3 SuperMini" style="width: 100px; height: 100px; object-fit: cover; border-radius: 6px; display: block; margin: 0 auto 0.5em;">
          <div style="text-align:center;">ESP32S3 SuperMini</div>
        </div>
        <div class="board-option" data-board="esp32c3-zero" tabindex="0" style="cursor:pointer; border: 2px solid #ccc; border-radius: 8px; padding: 0.5em; background: #fafafa; transition: border 0.2s;">
          <img src="images/c3zero.jpg" alt="ESP32C3 Zero" style="width: 100px; height: 100px; object-fit: cover; border-radius: 6px; display: block; margin: 0 auto 0.5em;">
          <div style="text-align:center;">ESP32C3 Zero</div>
        </div>
        <div class="board-option" data-board="esp32c3-supermini" tabindex="0" style="cursor:pointer; border: 2px solid #ccc; border-radius: 8px; padding: 0.5em; background: #fafafa; transition: border 0.2s;">
          <img src="images/c3supermini.jpg" alt="ESP32C3 SuperMini" style="width: 100px; height: 100px; object-fit: cover; border-radius: 6px; display: block; margin: 0 auto 0.5em;">
          <div style="text-align:center;">ESP32C3 SuperMini</div>
        </div>
        <div class="board-option" data-board="esp32s3-zero" tabindex="0" style="cursor:pointer; border: 2px solid #ccc; border-radius: 8px; padding: 0.5em; background: #fafafa; transition: border 0.2s;">
          <img src="images/s3zero.jpg" alt="ESP32S3 Zero" style="width: 100px; height: 100px; object-fit: cover; border-radius: 6px; display: block; margin: 0 auto 0.5em;">
          <div style="text-align:center;">ESP32S3 Zero</div>
        </div>
        <div class="board-option" data-board="atom-matrix" tabindex="0" style="cursor:pointer; border: 2px solid #ccc; border-radius: 8px; padding: 0.5em; background: #fafafa; transition: border 0.2s;">
          <img src="images/atom matrix.png" alt="ATOM Matrix" style="width: 100px; height: 100px; object-fit: cover; border-radius: 6px; display: block; margin: 0 auto 0.5em;">
          <div style="text-align:center;">ATOM Matrix</div>
        </div>
      </div>
    </div>
    <esp-web-install-button id="esp-flash" manifest="hardware/output/manifest-zero.json"></esp-web-install-button>
  </div>
  <div class="donate-box" style="margin:2em auto 0 auto; max-width:500px; background:#f8fafd; border-radius:10px; box-shadow:0 2px 8px #0001; padding:1.5em; text-align:center;">
    <div style="font-size:1.15em; color:#1976d2; font-weight:bold; margin-bottom:0.5em;">Want to support the project?</div>
    <div style="margin-bottom:1em; color:#333;">Consider signing up for a free printago.io account using our affiliate code <strong>SPUDER</strong></div>
    <a href="https://www.printago.io?via=spuder" target="_blank" rel="noopener noreferrer" style="display:inline-block; background:#1976d2; color:#fff; font-weight:bold; padding:0.7em 2em; border-radius:30px; text-decoration:none; box-shadow:0 2px 8px #0002; transition:background 0.2s, color 0.2s;">
      Sign up at Printago.io
    </a>
  </div>
  <div style="text-align:center; margin:2em auto 1em auto; font-size:1.1em; color:#555; font-style:italic;">
    From the same people who brought you <a href="https://github.com/spuder/openspool" target="_blank" rel="noopener noreferrer" style="font-weight:bold; color:#1976d2; text-decoration:underline;">OpenSpool</a>
  </div>
  <div style="text-align:center; margin:1em auto 2em auto;">
    <script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js" data-name="bmc-button" data-slug="openspool" data-color="#FFDD00" data-emoji="â˜•" data-font="Cookie" data-text="Buy me a coffee" data-outline-color="#000000" data-font-color="#000000" data-coffee-color="#ffffff"></script>
  </div>
  <script>
    // Map board value to manifest file (using raw GitHub URLs)
    const manifestMap = {
      'esp32s3-zero': 'https://raw.githubusercontent.com/spuder/PrintFarmButton/main/firmware/output/manifest-zero.json',
      'esp32s3-supermini': 'https://raw.githubusercontent.com/spuder/PrintFarmButton/main/firmware/output/manifest-supermini.json',
      'esp32c3-zero': 'https://raw.githubusercontent.com/spuder/PrintFarmButton/main/firmware/output/manifest-zero.json',
      'esp32c3-supermini': 'https://raw.githubusercontent.com/spuder/PrintFarmButton/main/firmware/output/manifest-supermini.json',
      'atom-matrix': 'https://raw.githubusercontent.com/spuder/PrintFarmButton/main/firmware/output/manifest-atom-matrix.json',
    };
    const flashBtn = document.getElementById('esp-flash');
    // Select all board options, including kit
    const boardOptions = document.querySelectorAll('.board-option');
    let selectedBoard = 'esp32s3-zero';
    function updateSelection(board) {
      selectedBoard = board;
      boardOptions.forEach(opt => {
        if (opt.getAttribute('data-board') === board) {
          opt.style.border = '2px solid #3c84ce';
          opt.style.background = '#e6f0fa';
        } else {
          opt.style.border = '2px solid #ccc';
          opt.style.background = '#fafafa';
        }
      });
      flashBtn.setAttribute('manifest', manifestMap[board]);
    }
    boardOptions.forEach(opt => {
      opt.addEventListener('click', () => updateSelection(opt.getAttribute('data-board')));
      opt.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          updateSelection(opt.getAttribute('data-board'));
        }
      });
    });
    // Set initial selection
    updateSelection(selectedBoard);
  </script>
</body>
</html>
